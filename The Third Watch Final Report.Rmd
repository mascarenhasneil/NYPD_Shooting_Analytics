---
title: "Team 2: The Third Watch <br> <br> NYPD Shootout Analysis Report <br><br>" 
author: "<font size =6, color='white'>Dr Vladimir Shapiro</font>"
date: "<font size =6, color='white'>May 21, 2021</font>"

output:
  prettydoc::html_pretty:
    theme: architect
    highlight: github
    math: mathjax
    number_sections: FALSE
    css: "images//style.css"


---

```{=html}
<p style="font-size:15px;text-align:left;"><i>Source: https://images.app.goo.gl/YStTSgPUfhG5JeYn7</i></p>
<center>
College of Professional Studies, Northeastern University<br>
ALY6015 80625 Intermediate Analytics SEC 04 <br>
Spring 2021 CPS [BOS-A-HY]<br>
<strong>Team Members: </strong>
Aswin Kumar Rajendran, 
Chaya Kotturesh 
and Neil Mascarenhas
<br><br><br><br><br>
</center>

```

```{r warning=FALSE, error=FALSE, message=FALSE, eval=TRUE, echo=FALSE, cache=TRUE, eval=TRUE}

'%ni%' <- Negate('%in%')

### We are creating this function to generate unique figure Ids in continuous order to comply with APA guidelines and use them while we are referring to them.  

Figure_Count <<- 0   ### Sets the count to initial 0  << means that the variable is global
GetFigureCount <- function()  ### Creating the function and it will be used when we need to add a figure id. 
{Figure_Count <<- Figure_Count + 1  ## Increments the count so that we get new id every single tile
return(paste("Figure :",Figure_Count))}### Returns back the values, later to be used in the assignment.


installAllPackages <- function(Pkgs){
    new.Pkgs <- Pkgs[!(Pkgs %in% installed.packages()[, "Package"])]
    if (length(new.Pkgs)) 
        install.packages(new.Pkgs, dependencies = TRUE)
    null<- sapply(Pkgs, require, character.only = TRUE)
    
}


options(scipen=5)   #  A penalty to be applied when deciding to print numeric values in fixed or exponential notation.
options(digits = 3)   # Globally sets 3 places after decimal point
options(knitr.kable.NA = '')
knitr::opts_chunk$set(tidy=TRUE)  ## Reformat the R code
knitr::opts_chunk$set(tidy.opts = list(blank = FALSE, width.cutoff = 100))  ## Removed blank lines and try to cut the code lines at set(100) characters.
knitr::opts_chunk$set(cache=TRUE)   ## Make execution faster. When evaluating code chunks for the second time, the cached chunks are skipped (unless they have been modified).
knitr::opts_chunk$set(comment = ' ')  ## remove the default ## from the output prefix.
knitr::opts_chunk$set(fig.align = "Center") ## All figures center align.

```
```{=html}
<hr><p id="MainPoint"> Introduction </p><hr>
```



This paper summarizes our preliminary (Exploratory Data Analysis - EDA) analysis on the selected dataset, the NYPD shooting incident dataset for this group project. It will share some insightful results from the EDA and descriptive statistics. Further, this paper identifies a set of methods used to answer the business questions on the dataset and justifies those methods using statistics and analytics concepts. 



#### First, let us create the environment by importing the required packages to analyze and create a visualization on the dataset.


```{r warning=FALSE, error=FALSE, message=FALSE, eval=TRUE, echo=FALSE, tidy=FALSE, tidy.opts = list(blank = FALSE, width.cutoff = 100), cache=FALSE}
packages <- c(
    "dplyr", "psych", "plyr", "reshape2", "rlang",  "patchwork",  ## Tools to work with core language features of R and the tidyverse
    "scales", "grid", "UsingR", "tidyr", "tidyverse", ## For Data cleaning and processing
    "readxl", ## This package makes it possible to read Excel (.xlsx) files to r.
    "ggplot2","ggpubr", "RColorBrewer", "gplots",
    "rmarkdown","formatR",  ## To format R markdown and add features
    "plotly","gmodels",   ## To plot realistic, interactive plots
    "knitr","kableExtra", ## To display tables in beautiful format.
    "base64","base64enc", ## To use Base 64 encryption 
    "enc",        ## DOC: https://cran.r-project.org/web/packages/enc/enc.pdf
    "EDA",        ## DOC: https://cran.r-project.org/web/packages/dlookr/vignettes/EDA.html
    "hrbrthemes", ## Adds extra themes for html rendering
    "ggcorrplot",  ## Extensively for Correlation Plots in ggplot",
    "corrplot",    ## For visualizing correlation matrices and confidence intervals. It also contains some algorithms to do matrix reordering
    "Publish", "magrittr", ### Used to add column names with piping
    "PerformanceAnalytics", ### Used to Draw scatter plots on Correlation matrix
    "forecast", ## Required for the EDA Report
    "xfun",   ## Is used to add eternal files and read them to this Markdown. 
    "htmltools", ## Helps to display HTML in the Markdown (and pdf when we knit)
    "funModeling", # Used to run Status function.
    "corrgram", # Used to Plot corplots using ggplot engine.
    "dummies", # Used to create dummies
    "lsmeans", ## Used to plot lm
    "imputeTS", ## Used by na.mean() function
    "leaps", ## Best for Subsets regsubsets()  
    "lmSubsets", ## For all subset function
    "sjPlot", "nhstplot", ## Used to plot Chi-Square
    "gtsummary", ## to have better summary of data
    "ROCR",    ## Used to check for performance 
    "InformationValue",  ## Used by optimalCutoff function
    "caTools", ## Used to Split data into test and train.
    "coefplot", ## Used to plot Coefficients.
    "mltools",  ## Calculate Root-Mean-Square Error (Deviation)
    "caret",      ## Used to generate confusion matrix
    "glmnet",   ## To run ridge and lasso regularization on models using cv.glmnet and glmnet function.
    "descr", "vcd", ## To run autocrads test.
    "mlbench", ### Machine learning baenchmarking 
    "randomForest", ## To model randomForests and run plots
    "epiDisplay"#,"psychTools", "moments", "Hmisc","skimr", "DataExplore", "visdat", "mapview" 
)
    
installAllPackages(packages)
# 
# if(installAllPackages(packages)) 
#     cat("Done, Installed and imported All the required packages and libraries for this assignment") else 
#     cat("Some Error in installation")
#     cat("Done")
#     
```


## Business Questions
1.	Is there a relationship between the Race of the victim and the Perpetrator who died in the shooting incident? *by Chaya Kotturesh*

2.	Is there any noticeable relationship between the Perpetrator's Race to the victim's sex and age with a motive to recognize the Perpetrator's race pattern? *by Neil Mascarenhas*

3.	Recognize the pattern/relationship between the victim's age and the Location, specifically Bar/Night Club, to recognize the trend throughout the years and increase the patrolling.  *by Aswin Kumar Rajendran*


```{=html}
<hr><p id="MainPoint"> Analysis and Interpretations </p><hr>
```


```{r}

NYPD = data.frame(read_csv("Data\\NYPD_Shooting_Incident_Data__Historic_.csv", skip_empty_rows = TRUE), stringsAsFactors = T)


### Removing unwanted variables/ columns
### 

NYPD <- NYPD %>%
    select(-INCIDENT_KEY, -X_COORD_CD, -Y_COORD_CD, -Latitude, -Longitude, -Lon_Lat)


NYPD[duplicated(NYPD$INCIDENT_KEY),]



Datatypelist<-as.data.frame(skimr::skim(NYPD)[[1]],skimr::skim(NYPD)[[2]])

knitr::kable(Datatypelist, "pipe", col.names = "Data Type")

#$`skimr::skim(NYPD)[[1]]`=="character"

```



